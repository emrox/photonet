<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/bootstrap.min.css">
    <script src="/static/jquery-2.1.4.min.js"></script>
    <script src="/static/dropzone.js"></script>
    <script src="/static/bootstrap.min.js"></script>
    <script src="/static/handlebars-v3.0.3.js"></script>
    <style>
     .image img { width: 100%; cursor: pointer; }
     .modal-header { border-bottom: none; }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>

  <body class="container">
    <h1>Photo basket</h1>

    <script id="thumbnail-template" type="text/x-handlebars-template">
      <div class="col-xs-3 image"><img src="{{path}}"></div>
    </script>

    <div class="row" id='thumbnails'>
    </div>

    <div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title"></h4>
          </div>
          <div class="modal-body">
            <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
              <!-- Wrapper for slides -->
              <div class="carousel-inner" id="fullscreen-images" role="listbox">
              </div>

              <!-- Controls -->
              <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>
          </div>
        </div>
      </div>
      </div>

    <form action="/album/urlaub2015/x83hdz7w6x5dbn4t/upload"
          class="dropzone"
          id="my-awesome-dropzone">
    </form>

    <script>
     $(document).ready(function () {
         $.ajax({url: '/album/IRGENDWAS/IRGENDWAS'}).done(function(data) {
             for (var i = 0; i < data.images.length; i++) {
                 $('#thumbnails').append('<div class="col-xs-3 image"><img data-image-id="' +
                                         i+ '" src="' +
                                         data.images[i].thumb320 + '"></div>');
                 $('#fullscreen-images').append('<div class="item"><img data-image-id="' + i + '" src="' +
                                                data.images[i].url + '"></div>');
             }
             $('.image img').click(function(evt) {
                 var image_id = $(evt.target).data('image-id');
                 $('#fullscreen-images .item img').each(function (index, img) {
                     var $img = $(img);
                     if ($img.data('image-id') == image_id) {
                         $img.parent().addClass('active');
                     } else {
                         $img.parent().removeClass('active');
                     }
                 });
                 $('#myModal').modal();
             });
         });
         var source = $('thumbnail-template').html();
         $('.carousel').carousel({interval: false});
     });
    </script>
  </body>
</html>
